{"version":3,"sources":["infrastructure/CommonComponents.js","infrastructure/ComponentConfiguration.js","infrastructure/ComponentManager.js","infrastructure/TemplateFromUrlComponentLoader.js"],"names":["setupSimpleViewModel","viewModel","value","id","prefix","ko","isObservable","observable","unwrap","Date","getTime","ToggleSwitch","ComponentConfiguration","params","Slider","name","viewModelInstance","viewUrl","preProcessor","postProcessor","ComponentManager","componentLoader","components","loaders","unshift","forEach","component","console","log","registration","instance","template","fromUrl","constructor","replace","processors","pre","post","register","TemplateFromUrlComponentLoader","viewPath","endsWith","templateConfig","callback","fullUrl","maxCacheAge","$","get","markupString","defaultLoader","loadTemplate"],"mappings":"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","file":"one-inch-punch.js","sourcesContent":["/* eslint-disable no-param-reassign */\nimport ComponentConfiguration from './ComponentConfiguration.js';\n\nfunction setupSimpleViewModel(viewModel, value, id = null, prefix = 'component-') {\n\tif (ko.isObservable(value))\n\t\tviewModel.value = value;\n\telse\n\t\tviewModel.value = ko.observable(value || false);\n\n\t// ToDo: Fix the auto-id bug\n\tviewModel.id = `${prefix}${(id && ko.unwrap(id)) || new Date().getTime()}`;\n}\n\nconst ToggleSwitch = new ComponentConfiguration(\n\t'toggle',\n\tfunction viewModel(params) {\n\t\tsetupSimpleViewModel(this, params.value, params.id, 'toggle-switch-');\n\t},\n\t'/app/components/toggleswitch.html'\n);\n\nconst Slider = new ComponentConfiguration(\n\t'slider',\n\tfunction viewModel(params) {\n\t\tsetupSimpleViewModel(this, params.value, params.id, 'slider-');\n\t},\n\t'/app/components/slider.html'\n);\n\n\nexport default [\n\tToggleSwitch, Slider\n];\n","export default class ComponentConfiguration {\n\tconstructor(name, viewModelInstance, viewUrl = null, preProcessor = null, postProcessor = null) {\n\t\tthis.name = name;\n\t\tthis.viewModelInstance = viewModelInstance;\n\t\tthis.viewUrl = viewUrl;\n\t\tthis.preProcessor = preProcessor;\n\t\tthis.postProcessor = postProcessor;\n\t}\n}\n","/* eslint-disable class-methods-use-this */\nclass ComponentManager {\n\tinit(componentLoader) {\n\t\tko.components.loaders.unshift(componentLoader);\n\t}\n\n\tregister(components) {\n\t\tcomponents.forEach((component) => {\n\t\t\tconsole.log('processing component', component);\n\t\t\tconst registration = {\n\t\t\t\tviewModel: {\n\t\t\t\t\tinstance: component.viewModelInstance\n\t\t\t\t},\n\t\t\t\ttemplate: {\n\t\t\t\t\tfromUrl: component.viewUrl || `/app/views/${component.viewModelInstance.constructor.name.replace('ViewModel', 'View')}.html`,\n\t\t\t\t\tprocessors: {\n\t\t\t\t\t\tpre: component.preProcessor,\n\t\t\t\t\t\tpost: component.postProcessor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (typeof (component.viewModelInstance) === 'function') {\n\t\t\t\tregistration.viewModel = component.viewModelInstance;\n\t\t\t} else {\n\t\t\t\tregistration.viewModel = {\n\t\t\t\t\tinstance: component.viewModelInstance\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tko.components.register(component.name, registration);\n\t\t});\n\t}\n}\n\nexport default new ComponentManager();\n","export default class TemplateFromUrlComponentLoader {\n\tconstructor(viewPath = '') {\n\t\tthis.viewPath = viewPath;\n\t\tif (this.viewPath && !this.viewPath.endsWith('/'))\n\t\t\tthis.viewPath += '/';\n\t}\n\n\tloadTemplate(name, templateConfig, callback) {\t\t\n\t\tif (templateConfig.fromUrl) {\n\t\t\t// Uses jQuery's ajax facility to load the markup from a file\n\t\t\tconst fullUrl = `${this.viewPath}${templateConfig.fromUrl}?cacheAge=${templateConfig.maxCacheAge}`;\n\n\t\t\t$.get(fullUrl, (markupString) => {\n\t\t\t\tif (templateConfig.processors && templateConfig.processors.pre)\n\t\t\t\t\ttemplateConfig.processors.pre();\n\n\t\t\t\t// We need an array of DOM nodes, not a string.\n\t\t\t\t// We can use the default loader to convert to the\n\t\t\t\t// required format.\n\t\t\t\tko.components.defaultLoader.loadTemplate(name, markupString, callback);\n\t\t\t\tif (templateConfig.processors && templateConfig.processors.post)\n\t\t\t\t\ttemplateConfig.processors.post();\n\t\t\t});\n\t\t} else {\n\t\t\t// Unrecognized config format. Let another loader handle it.\n\t\t\tcallback(null);\n\t\t}\n\t}\n}\n"]}